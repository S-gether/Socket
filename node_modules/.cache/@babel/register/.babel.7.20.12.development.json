{"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Hongmu\\\\Desktop\\\\Projects\\\\nodejs\\\\reference\\\\webrtc\\\\zoom_clone\\\\src\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Hongmu\\\\Desktop\\\\Projects\\\\nodejs\\\\reference\\\\webrtc\\\\zoom_clone\",\"filename\":\"C:\\\\Users\\\\Hongmu\\\\Desktop\\\\Projects\\\\nodejs\\\\reference\\\\webrtc\\\\zoom_clone\\\\src\\\\server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Hongmu\\\\Desktop\\\\Projects\\\\nodejs\\\\reference\\\\webrtc\\\\zoom_clone\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-numeric-separator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null,null]},\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":{},\"_verified\":{},\"ClassDeclaration\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.12:development":{"value":{"code":"\"use strict\";\n\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _socket = _interopRequireDefault(require(\"socket.io\"));\nvar _http = _interopRequireDefault(require(\"http\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n// import WebSocket from \"ws\";\n\nvar PORT = process.env.PORT || 4000;\nvar app = (0, _express[\"default\"])();\napp.set(\"view engine\", \"pug\");\napp.set(\"views\", process.cwd() + \"/src/views\");\napp.use(\"/public\", _express[\"default\"][\"static\"](process.cwd() + \"/src/public\"));\napp.get(\"/\", function (req, res) {\n  res.render(\"home\");\n});\napp.get(\"/*\", function (req, res) {\n  res.redirect(\"/\");\n});\nvar httpServer = _http[\"default\"].createServer(app);\nvar wsServer = (0, _socket[\"default\"])(httpServer);\nvar roomObjArr = [\n  // {\n  //   roomName,\n  //   currentNum,\n  //   users: [\n  //     {\n  //       socketId,\n  //       nickname,\n  //     },\n  //   ],\n  // },\n];\nvar MAXIMUM = 5;\nwsServer.on(\"connection\", function (socket) {\n  var myRoomName = null;\n  var myNickname = null;\n  socket.on(\"join\", function (roomName, nickname) {\n    console.log('join');\n    myRoomName = roomName;\n    myNickname = nickname;\n    var isRoomExist = false;\n    var targetRoomObj = null;\n\n    // forEach를 사용하지 않는 이유: callback함수를 사용하기 때문에 return이 효용없음.\n    for (var i = 0; i < roomObjArr.length; ++i) {\n      if (roomObjArr[i].roomName === roomName) {\n        // Reject join the room\n        if (roomObjArr[i].currentNum >= MAXIMUM) {\n          socket.emit(\"reject_join\");\n          return;\n        }\n        isRoomExist = true;\n        targetRoomObj = roomObjArr[i];\n        break;\n      }\n    }\n\n    // Create room\n    if (!isRoomExist) {\n      targetRoomObj = {\n        roomName: roomName,\n        currentNum: 0,\n        users: []\n      };\n      roomObjArr.push(targetRoomObj);\n    }\n\n    //Join the room\n    targetRoomObj.users.push({\n      socketId: socket.id,\n      nickname: nickname\n    });\n    ++targetRoomObj.currentNum;\n    socket.join(roomName);\n    socket.emit(\"join\", targetRoomObj.users);\n  });\n  socket.on(\"offer\", function (offer, remoteSocketId, localNickname) {\n    console.log('offer');\n    socket.to(remoteSocketId).emit(\"offer\", offer, socket.id, localNickname);\n  });\n  socket.on(\"answer\", function (answer, remoteSocketId) {\n    socket.to(remoteSocketId).emit(\"answer\", answer, socket.id);\n  });\n  socket.on(\"ice\", function (ice, remoteSocketId) {\n    socket.to(remoteSocketId).emit(\"ice\", ice, socket.id);\n  });\n  socket.on(\"chat\", function (message, roomName) {\n    socket.to(roomName).emit(\"chat\", message);\n  });\n  socket.on(\"disconnecting\", function () {\n    socket.to(myRoomName).emit(\"leave_room\", socket.id, myNickname);\n    var isRoomEmpty = false;\n    for (var i = 0; i < roomObjArr.length; ++i) {\n      if (roomObjArr[i].roomName === myRoomName) {\n        var newUsers = roomObjArr[i].users.filter(function (user) {\n          return user.socketId != socket.id;\n        });\n        roomObjArr[i].users = newUsers;\n        --roomObjArr[i].currentNum;\n        if (roomObjArr[i].currentNum == 0) {\n          isRoomEmpty = true;\n        }\n      }\n    }\n\n    // Delete room\n    if (isRoomEmpty) {\n      var newRoomObjArr = roomObjArr.filter(function (roomObj) {\n        return roomObj.currentNum != 0;\n      });\n      roomObjArr = newRoomObjArr;\n    }\n  });\n});\nvar handleListen = function handleListen() {\n  return console.log(\"\\u2705 Listening on http://localhost:\".concat(PORT));\n};\nhttpServer.listen(PORT, handleListen);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQT1JUIiwicHJvY2VzcyIsImVudiIsImFwcCIsImV4cHJlc3MiLCJzZXQiLCJjd2QiLCJ1c2UiLCJnZXQiLCJyZXEiLCJyZXMiLCJyZW5kZXIiLCJyZWRpcmVjdCIsImh0dHBTZXJ2ZXIiLCJodHRwIiwiY3JlYXRlU2VydmVyIiwid3NTZXJ2ZXIiLCJTb2NrZXRJTyIsInJvb21PYmpBcnIiLCJNQVhJTVVNIiwib24iLCJzb2NrZXQiLCJteVJvb21OYW1lIiwibXlOaWNrbmFtZSIsInJvb21OYW1lIiwibmlja25hbWUiLCJjb25zb2xlIiwibG9nIiwiaXNSb29tRXhpc3QiLCJ0YXJnZXRSb29tT2JqIiwiaSIsImxlbmd0aCIsImN1cnJlbnROdW0iLCJlbWl0IiwidXNlcnMiLCJwdXNoIiwic29ja2V0SWQiLCJpZCIsImpvaW4iLCJvZmZlciIsInJlbW90ZVNvY2tldElkIiwibG9jYWxOaWNrbmFtZSIsInRvIiwiYW5zd2VyIiwiaWNlIiwibWVzc2FnZSIsImlzUm9vbUVtcHR5IiwibmV3VXNlcnMiLCJmaWx0ZXIiLCJ1c2VyIiwibmV3Um9vbU9iakFyciIsInJvb21PYmoiLCJoYW5kbGVMaXN0ZW4iLCJsaXN0ZW4iXSwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcSG9uZ211XFxEZXNrdG9wXFxQcm9qZWN0c1xcbm9kZWpzXFxyZWZlcmVuY2VcXHdlYnJ0Y1xcem9vbV9jbG9uZVxcc3JjXFwiLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tIFwiZXhwcmVzc1wiO1xyXG4vLyBpbXBvcnQgV2ViU29ja2V0IGZyb20gXCJ3c1wiO1xyXG5pbXBvcnQgU29ja2V0SU8gZnJvbSBcInNvY2tldC5pb1wiO1xyXG5pbXBvcnQgaHR0cCBmcm9tIFwiaHR0cFwiO1xyXG5cclxuY29uc3QgUE9SVCA9IHByb2Nlc3MuZW52LlBPUlQgfHwgNDAwMDtcclxuXHJcbmNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcclxuXHJcbmFwcC5zZXQoXCJ2aWV3IGVuZ2luZVwiLCBcInB1Z1wiKTtcclxuYXBwLnNldChcInZpZXdzXCIsIHByb2Nlc3MuY3dkKCkgKyBcIi9zcmMvdmlld3NcIik7XHJcblxyXG5hcHAudXNlKFwiL3B1YmxpY1wiLCBleHByZXNzLnN0YXRpYyhwcm9jZXNzLmN3ZCgpICsgXCIvc3JjL3B1YmxpY1wiKSk7XHJcblxyXG5hcHAuZ2V0KFwiL1wiLCAocmVxLCByZXMpID0+IHtcclxuICByZXMucmVuZGVyKFwiaG9tZVwiKTtcclxufSk7XHJcblxyXG5hcHAuZ2V0KFwiLypcIiwgKHJlcSwgcmVzKSA9PiB7XHJcbiAgcmVzLnJlZGlyZWN0KFwiL1wiKTtcclxufSk7XHJcblxyXG5jb25zdCBodHRwU2VydmVyID0gaHR0cC5jcmVhdGVTZXJ2ZXIoYXBwKTtcclxuY29uc3Qgd3NTZXJ2ZXIgPSBTb2NrZXRJTyhodHRwU2VydmVyKTtcclxuXHJcbmxldCByb29tT2JqQXJyID0gW1xyXG4gIC8vIHtcclxuICAvLyAgIHJvb21OYW1lLFxyXG4gIC8vICAgY3VycmVudE51bSxcclxuICAvLyAgIHVzZXJzOiBbXHJcbiAgLy8gICAgIHtcclxuICAvLyAgICAgICBzb2NrZXRJZCxcclxuICAvLyAgICAgICBuaWNrbmFtZSxcclxuICAvLyAgICAgfSxcclxuICAvLyAgIF0sXHJcbiAgLy8gfSxcclxuXTtcclxuY29uc3QgTUFYSU1VTSA9IDU7XHJcblxyXG53c1NlcnZlci5vbihcImNvbm5lY3Rpb25cIiwgKHNvY2tldCkgPT4ge1xyXG4gIGxldCBteVJvb21OYW1lID0gbnVsbDtcclxuICBsZXQgbXlOaWNrbmFtZSA9IG51bGw7XHJcblxyXG4gIHNvY2tldC5vbihcImpvaW5cIiwgKHJvb21OYW1lLCBuaWNrbmFtZSkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coJ2pvaW4nKVxyXG4gICAgbXlSb29tTmFtZSA9IHJvb21OYW1lO1xyXG4gICAgbXlOaWNrbmFtZSA9IG5pY2tuYW1lO1xyXG5cclxuICAgIGxldCBpc1Jvb21FeGlzdCA9IGZhbHNlO1xyXG4gICAgbGV0IHRhcmdldFJvb21PYmogPSBudWxsO1xyXG5cclxuICAgIC8vIGZvckVhY2jrpbwg7IKs7Jqp7ZWY7KeAIOyViuuKlCDsnbTsnKA6IGNhbGxiYWNr7ZWo7IiY66W8IOyCrOyaqe2VmOq4sCDrlYzrrLjsl5AgcmV0dXJu7J20IO2aqOyaqeyXhuydjC5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm9vbU9iakFyci5sZW5ndGg7ICsraSkge1xyXG4gICAgICBpZiAocm9vbU9iakFycltpXS5yb29tTmFtZSA9PT0gcm9vbU5hbWUpIHtcclxuICAgICAgICAvLyBSZWplY3Qgam9pbiB0aGUgcm9vbVxyXG4gICAgICAgIGlmIChyb29tT2JqQXJyW2ldLmN1cnJlbnROdW0gPj0gTUFYSU1VTSkge1xyXG4gICAgICAgICAgc29ja2V0LmVtaXQoXCJyZWplY3Rfam9pblwiKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlzUm9vbUV4aXN0ID0gdHJ1ZTtcclxuICAgICAgICB0YXJnZXRSb29tT2JqID0gcm9vbU9iakFycltpXTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIENyZWF0ZSByb29tXHJcbiAgICBpZiAoIWlzUm9vbUV4aXN0KSB7XHJcbiAgICAgIHRhcmdldFJvb21PYmogPSB7XHJcbiAgICAgICAgcm9vbU5hbWUsXHJcbiAgICAgICAgY3VycmVudE51bTogMCxcclxuICAgICAgICB1c2VyczogW10sXHJcbiAgICAgIH07XHJcbiAgICAgIHJvb21PYmpBcnIucHVzaCh0YXJnZXRSb29tT2JqKTtcclxuICAgIH1cclxuXHJcbiAgICAvL0pvaW4gdGhlIHJvb21cclxuICAgIHRhcmdldFJvb21PYmoudXNlcnMucHVzaCh7XHJcbiAgICAgIHNvY2tldElkOiBzb2NrZXQuaWQsXHJcbiAgICAgIG5pY2tuYW1lLFxyXG4gICAgfSk7XHJcbiAgICArK3RhcmdldFJvb21PYmouY3VycmVudE51bTtcclxuXHJcbiAgICBzb2NrZXQuam9pbihyb29tTmFtZSk7XHJcbiAgICBzb2NrZXQuZW1pdChcImpvaW5cIiwgdGFyZ2V0Um9vbU9iai51c2Vycyk7XHJcbiAgfSk7XHJcblxyXG4gIHNvY2tldC5vbihcIm9mZmVyXCIsIChvZmZlciwgcmVtb3RlU29ja2V0SWQsIGxvY2FsTmlja25hbWUpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKCdvZmZlcicpXHJcbiAgICBzb2NrZXQudG8ocmVtb3RlU29ja2V0SWQpLmVtaXQoXCJvZmZlclwiLCBvZmZlciwgc29ja2V0LmlkLCBsb2NhbE5pY2tuYW1lKTtcclxuICB9KTtcclxuXHJcbiAgc29ja2V0Lm9uKFwiYW5zd2VyXCIsIChhbnN3ZXIsIHJlbW90ZVNvY2tldElkKSA9PiB7XHJcbiAgICBzb2NrZXQudG8ocmVtb3RlU29ja2V0SWQpLmVtaXQoXCJhbnN3ZXJcIiwgYW5zd2VyLCBzb2NrZXQuaWQpO1xyXG4gIH0pO1xyXG5cclxuICBzb2NrZXQub24oXCJpY2VcIiwgKGljZSwgcmVtb3RlU29ja2V0SWQpID0+IHtcclxuICAgIHNvY2tldC50byhyZW1vdGVTb2NrZXRJZCkuZW1pdChcImljZVwiLCBpY2UsIHNvY2tldC5pZCk7XHJcbiAgfSk7XHJcblxyXG4gIHNvY2tldC5vbihcImNoYXRcIiwgKG1lc3NhZ2UsIHJvb21OYW1lKSA9PiB7XHJcbiAgICBzb2NrZXQudG8ocm9vbU5hbWUpLmVtaXQoXCJjaGF0XCIsIG1lc3NhZ2UpO1xyXG4gIH0pO1xyXG5cclxuICBzb2NrZXQub24oXCJkaXNjb25uZWN0aW5nXCIsICgpID0+IHtcclxuICAgIHNvY2tldC50byhteVJvb21OYW1lKS5lbWl0KFwibGVhdmVfcm9vbVwiLCBzb2NrZXQuaWQsIG15Tmlja25hbWUpO1xyXG5cclxuICAgIGxldCBpc1Jvb21FbXB0eSA9IGZhbHNlO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb29tT2JqQXJyLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgIGlmIChyb29tT2JqQXJyW2ldLnJvb21OYW1lID09PSBteVJvb21OYW1lKSB7XHJcbiAgICAgICAgY29uc3QgbmV3VXNlcnMgPSByb29tT2JqQXJyW2ldLnVzZXJzLmZpbHRlcihcclxuICAgICAgICAgICh1c2VyKSA9PiB1c2VyLnNvY2tldElkICE9IHNvY2tldC5pZFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcm9vbU9iakFycltpXS51c2VycyA9IG5ld1VzZXJzO1xyXG4gICAgICAgIC0tcm9vbU9iakFycltpXS5jdXJyZW50TnVtO1xyXG5cclxuICAgICAgICBpZiAocm9vbU9iakFycltpXS5jdXJyZW50TnVtID09IDApIHtcclxuICAgICAgICAgIGlzUm9vbUVtcHR5ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBEZWxldGUgcm9vbVxyXG4gICAgaWYgKGlzUm9vbUVtcHR5KSB7XHJcbiAgICAgIGNvbnN0IG5ld1Jvb21PYmpBcnIgPSByb29tT2JqQXJyLmZpbHRlcihcclxuICAgICAgICAocm9vbU9iaikgPT4gcm9vbU9iai5jdXJyZW50TnVtICE9IDBcclxuICAgICAgKTtcclxuICAgICAgcm9vbU9iakFyciA9IG5ld1Jvb21PYmpBcnI7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuY29uc3QgaGFuZGxlTGlzdGVuID0gKCkgPT5cclxuICBjb25zb2xlLmxvZyhg4pyFIExpc3RlbmluZyBvbiBodHRwOi8vbG9jYWxob3N0OiR7UE9SVH1gKTtcclxuaHR0cFNlcnZlci5saXN0ZW4oUE9SVCwgaGFuZGxlTGlzdGVuKTtcclxuIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBRUE7QUFDQTtBQUF3QjtBQUZ4Qjs7QUFJQSxJQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRixJQUFJLElBQUksSUFBSTtBQUVyQyxJQUFNRyxHQUFHLEdBQUcsSUFBQUMsbUJBQU8sR0FBRTtBQUVyQkQsR0FBRyxDQUFDRSxH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","map":{"version":3,"names":["PORT","process","env","app","express","set","cwd","use","get","req","res","render","redirect","httpServer","http","createServer","wsServer","SocketIO","roomObjArr","MAXIMUM","on","socket","myRoomName","myNickname","roomName","nickname","console","log","isRoomExist","targetRoomObj","i","length","currentNum","emit","users","push","socketId","id","join","offer","remoteSocketId","localNickname","to","answer","ice","message","isRoomEmpty","newUsers","filter","user","newRoomObjArr","roomObj","handleListen","listen"],"sourceRoot":"C:\\Users\\Hongmu\\Desktop\\Projects\\nodejs\\reference\\webrtc\\zoom_clone\\src\\","sources":["server.js"],"sourcesContent":["import express from \"express\";\r\n// import WebSocket from \"ws\";\r\nimport SocketIO from \"socket.io\";\r\nimport http from \"http\";\r\n\r\nconst PORT = process.env.PORT || 4000;\r\n\r\nconst app = express();\r\n\r\napp.set(\"view engine\", \"pug\");\r\napp.set(\"views\", process.cwd() + \"/src/views\");\r\n\r\napp.use(\"/public\", express.static(process.cwd() + \"/src/public\"));\r\n\r\napp.get(\"/\", (req, res) => {\r\n  res.render(\"home\");\r\n});\r\n\r\napp.get(\"/*\", (req, res) => {\r\n  res.redirect(\"/\");\r\n});\r\n\r\nconst httpServer = http.createServer(app);\r\nconst wsServer = SocketIO(httpServer);\r\n\r\nlet roomObjArr = [\r\n  // {\r\n  //   roomName,\r\n  //   currentNum,\r\n  //   users: [\r\n  //     {\r\n  //       socketId,\r\n  //       nickname,\r\n  //     },\r\n  //   ],\r\n  // },\r\n];\r\nconst MAXIMUM = 5;\r\n\r\nwsServer.on(\"connection\", (socket) => {\r\n  let myRoomName = null;\r\n  let myNickname = null;\r\n\r\n  socket.on(\"join\", (roomName, nickname) => {\r\n    console.log('join')\r\n    myRoomName = roomName;\r\n    myNickname = nickname;\r\n\r\n    let isRoomExist = false;\r\n    let targetRoomObj = null;\r\n\r\n    // forEach를 사용하지 않는 이유: callback함수를 사용하기 때문에 return이 효용없음.\r\n    for (let i = 0; i < roomObjArr.length; ++i) {\r\n      if (roomObjArr[i].roomName === roomName) {\r\n        // Reject join the room\r\n        if (roomObjArr[i].currentNum >= MAXIMUM) {\r\n          socket.emit(\"reject_join\");\r\n          return;\r\n        }\r\n\r\n        isRoomExist = true;\r\n        targetRoomObj = roomObjArr[i];\r\n        break;\r\n      }\r\n    }\r\n\r\n    // Create room\r\n    if (!isRoomExist) {\r\n      targetRoomObj = {\r\n        roomName,\r\n        currentNum: 0,\r\n        users: [],\r\n      };\r\n      roomObjArr.push(targetRoomObj);\r\n    }\r\n\r\n    //Join the room\r\n    targetRoomObj.users.push({\r\n      socketId: socket.id,\r\n      nickname,\r\n    });\r\n    ++targetRoomObj.currentNum;\r\n\r\n    socket.join(roomName);\r\n    socket.emit(\"join\", targetRoomObj.users);\r\n  });\r\n\r\n  socket.on(\"offer\", (offer, remoteSocketId, localNickname) => {\r\n    console.log('offer')\r\n    socket.to(remoteSocketId).emit(\"offer\", offer, socket.id, localNickname);\r\n  });\r\n\r\n  socket.on(\"answer\", (answer, remoteSocketId) => {\r\n    socket.to(remoteSocketId).emit(\"answer\", answer, socket.id);\r\n  });\r\n\r\n  socket.on(\"ice\", (ice, remoteSocketId) => {\r\n    socket.to(remoteSocketId).emit(\"ice\", ice, socket.id);\r\n  });\r\n\r\n  socket.on(\"chat\", (message, roomName) => {\r\n    socket.to(roomName).emit(\"chat\", message);\r\n  });\r\n\r\n  socket.on(\"disconnecting\", () => {\r\n    socket.to(myRoomName).emit(\"leave_room\", socket.id, myNickname);\r\n\r\n    let isRoomEmpty = false;\r\n    for (let i = 0; i < roomObjArr.length; ++i) {\r\n      if (roomObjArr[i].roomName === myRoomName) {\r\n        const newUsers = roomObjArr[i].users.filter(\r\n          (user) => user.socketId != socket.id\r\n        );\r\n        roomObjArr[i].users = newUsers;\r\n        --roomObjArr[i].currentNum;\r\n\r\n        if (roomObjArr[i].currentNum == 0) {\r\n          isRoomEmpty = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Delete room\r\n    if (isRoomEmpty) {\r\n      const newRoomObjArr = roomObjArr.filter(\r\n        (roomObj) => roomObj.currentNum != 0\r\n      );\r\n      roomObjArr = newRoomObjArr;\r\n    }\r\n  });\r\n});\r\n\r\nconst handleListen = () =>\r\n  console.log(`✅ Listening on http://localhost:${PORT}`);\r\nhttpServer.listen(PORT, handleListen);\r\n"],"mappings":"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"}},"mtime":1674690250089}}